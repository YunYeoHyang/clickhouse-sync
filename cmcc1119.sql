create table cmcc_panorama on cluster cmcc_cluster_replicas
(
    phone_no_e                     String comment     '前三后二手机号',
    phone_no                       String comment     '手机号',
    imei                           String comment     '当前imei',
    innet_area                     String comment     '基础标签:手机号归属地',
    factory_desc                   String comment     '基础标签:当前终端品牌',
    resident_area                  String comment     '位置标签:手机常驻地',
    mon_fee                        Float64  comment   '基础标签:当月总费用',
    inter_toll_fee                 Float64 comment    '基础标签:当月国际长途费用',
    inter_roam_fee                 Float64  comment   '基础标签:当月国际漫游费用',
    total_flux                     Float64 comment    '基础标签:当月使用总流量',
    home_work_distance             Float64  comment   '位置标签:日夜常驻地距离',
    weichat_flux                   Float64 comment    '基础标签:微信使用流量',
    flightapp_flux                 Float64 comment    '其他行为标签:航空类app使用流量',
    videoapp_flux                  Float64 comment    '其他行为标签:视频类app使用流量',
    oversea_edu_flux               Float64 comment    '其他行为标签:留学教育类app使用流量',
    vocational_edu_flux            Float64 comment    '其他行为标签:职业教育类app使用流量',
    school_edu_flux                Float64 comment    '其他行为标签:中小学教育类app使用流量',
    jobapp_flux                    Float64 comment    '其他行为标签:职场类app使用流量',
    babyapp_flux                   Float64 comment    '其他行为标签:母婴类app使用流量',
    taobao_flux                    Float64 comment    '其他行为标签:淘宝使用流量',
    jd_flux                        Float64 comment    '其他行为标签:京东使用流量',
    shopapp_flux                   Float64 comment    '其他行为标签:购物类app使用流量',
    car_trade_flux                 Float64 comment    '其他行为标签:汽车交易类app使用流量',
    car_maintenance_flux           Float64 comment    '其他行为标签:汽车保养类app使用流量',
    house_trade_flux               Float64 comment    '其他行为标签:房屋交易类app使用流量',
    house_decoration_flux          Float64 comment    '其他行为标签:房屋装修类app使用流量',
    alipay_flux                    Float64 comment    '金融行为标签:支付宝使用流量',
    bondapp_flux                   Float64 comment    '金融行为标签:股票类app使用流量',
    econapp_flux                   Float64 comment    '金融行为标签:理财类app使用流量',
    loanapp_flux                   Float64 comment    '金融行为标签:贷款类app使用流量',
    insapp_flux                    Float64 comment    '金融行为标签:保险类app使用流量',
    cfapp_flux                     Float64 comment    '金融行为标签:消金类app使用流量',
    microcredit_flux               Float64 comment    '金融行为标签:网络小贷类app使用流量',
    creditapp_flux                 Float64 comment    '金融行为标签:信用卡类app使用流量',
    futures_flux                   Float64 comment    '金融行为标签:期货贵金属类app使用流量',
    bankapp_flux                   Float64 comment    '金融行为标签:银行类app使用流量',
    fundapp_flux                   Float64 comment    '金融行为标签:基金类app使用流量',
     coun_roam_num                 UInt16 comment     '基础标签:当月国内漫游通话次数',
     coun_toll_num                 UInt16 comment     '基础标签:当月国内长途通话次数',
     bank_sms_num                  UInt16 comment     '金融行为标签:银行短信次数',
     bank_sms_cnt                  UInt16 comment     '金融行为标签:银行短信家数',
     device_month                  UInt16 comment     '基础标签:当前终端使用时长',
     out_num                       UInt16 comment     '基础标签:当月主叫次数',
     in_num                        UInt16 comment     '基础标签:当月被叫次数',
     out_dura                      UInt16 comment     '基础标签:当月主叫时长',
     in_dura                       UInt16 comment     '基础标签:当月被叫时长',
     call_flag                     UInt16 comment     '基础标签:通话行为活跃度',
     internet_flag                 UInt16 comment     '基础标签:上网app行为活跃度',
     shopping_flag                 UInt16 comment     '金融行为标签:消费app行为活跃度',
     bank_flag                     UInt16 comment     '金融行为标签:银行app行为活跃度',
     econapp_flag                  UInt16 comment     '金融行为标签:投资理财app行为活跃度',
     loanapp_flag                  UInt16 comment     '金融行为标签:贷款app行为活跃度',
     creditapp_flag                UInt16 comment     '金融行为标签:信用卡app行为活跃度',
     taobao_jd_flag                UInt16 comment     '其他行为标签:淘宝京东app行为活跃度',
     flightapp_flag                UInt16 comment     '其他行为标签:航空app行为活跃度',
     car_house_app_flag            UInt16 comment     '其他行为标签:汽车房屋app行为活跃度',
     educationapp_flag             UInt16 comment     '其他行为标签:教育投资app行为活跃度',
     videoapp_flag                 UInt16 comment     '其他行为标签:视频app行为活跃度',
     jobapp_flag                   UInt16 comment     '其他行为标签:职场类app行为活跃度',
     babyapp_flag                  UInt16 comment     '其他行为标签:母婴类app行为活跃度',
     alipay_flag                   UInt16 comment     '金融行为标签:支付宝app行为活跃度',
     insapp_flag                   UInt16 comment     '金融行为标签:保险类app行为活跃度',
     travel_flag                   UInt16 comment     '基础标签:是否港澳台、欧美国家、亚洲国家出行行为',
     age                           UInt16 comment      '基础标签:年龄',
     gender                        UInt16 comment      '基础标签:性别',
     innet_month                   UInt16 comment     '基础标签:入网时长',
     grp_mbr_flag                  UInt16 comment     '基础标签:集团客户标签',
     vip                           UInt16 comment     '基础标签:客户星级',
     gat_visit_days_m6             UInt16 comment     '基础标签:近6个月去港澳台的天数',
     asia_visit_days_m6            UInt16 comment     '基础标签:近6个月去亚洲国家的天数',
     us_euro_visit_days_m6         UInt16 comment     '基础标签:近6个月去欧美国家的天数',
     creditcash                    UInt16 comment     '风险标签:套现标签',
     gamrisk                       UInt16 comment     '风险标签:赌博标签',
     unusualnumber                 UInt16 comment     '风险标签:小号标签',
     maintenancenumber             UInt16 comment     '风险标签:养卡标签',
     weichat_days                  UInt16 comment     '其他行为标签:微信使用天数',
     flightapp_cnt                 UInt16 comment     '其他行为标签:航空类app使用个数',
     flightapp_days                UInt16 comment     '其他行为标签:航空类app使用天数',
     videoapp_cnt                  UInt16 comment     '其他行为标签:视频类app使用个数',
     videoapp_days                 UInt16 comment     '其他行为标签:视频类app使用天数',
     oversea_edu_cnt               UInt16 comment     '其他行为标签:留学教育类app使用个数',
     oversea_edu_days              UInt16 comment     '其他行为标签:留学教育类app使用天数',
     vocational_edu_cnt            UInt16 comment     '其他行为标签:职业教育类app使用个数',
     vocational_edu_days           UInt16 comment     '其他行为标签:职业教育类app使用天数',
     school_edu_cnt                UInt16 comment     '其他行为标签:中小学教育类app使用个数',
     school_edu_days               UInt16 comment     '其他行为标签:中小学教育类app使用天数',
     jobapp_cnt                    UInt16 comment     '其他行为标签:职场类app使用个数',
     jobapp_days                   UInt16 comment     '其他行为标签:职场类app使用天数',
     babyapp_cnt                   UInt16 comment     '其他行为标签:母婴类app使用个数',
     babyapp_days                  UInt16 comment     '其他行为标签:母婴类app使用天数',
     taobao_days                   UInt16 comment     '其他行为标签:淘宝使用天数',
     jd_days                       UInt16 comment     '其他行为标签:京东使用天数',
     shopapp_cnt                   UInt16 comment     '其他行为标签:购物类app使用个数',
     shopapp_days                  UInt16 comment     '其他行为标签:购物类app使用天数',
     car_trade_cnt                 UInt16 comment     '其他行为标签:汽车交易类app使用个数',
     car_trade_days                UInt16 comment     '其他行为标签:汽车交易类app使用天数',
     car_maintenance_cnt           UInt16 comment     '其他行为标签:汽车保养类app使用个数',
     car_maintenance_days          UInt16 comment     '其他行为标签:汽车保养类app使用天数',
     house_trade_cnt               UInt16 comment     '其他行为标签:房屋交易类app使用个数',
     house_trade_days              UInt16 comment     '其他行为标签:房屋交易类app使用天数',
     house_decoration_cnt          UInt16 comment     '其他行为标签:房屋装修类app使用个数',
     house_decoration_days         UInt16 comment     '其他行为标签:房屋装修类app使用天数',
     alipay_days                   UInt16 comment     '金融行为标签:支付宝使用天数',
     bondapp_cnt                   UInt16 comment     '金融行为标签:股票类app使用个数',
     bondapp_days                  UInt16 comment     '金融行为标签:股票类app使用天数',
     econapp_cnt                   UInt16 comment     '金融行为标签:理财类app使用个数',
     econapp_days                  UInt16 comment     '金融行为标签:理财类app使用天数',
     loanapp_cnt                   UInt16 comment     '金融行为标签:贷款类app使用个数',
     loanapp_days                  UInt16 comment     '金融行为标签:贷款类app使用天数',
     insapp_cnt                    UInt16 comment     '金融行为标签:保险类app使用个数',
     insapp_days                   UInt16 comment     '金融行为标签:保险类app使用天数',
     cfapp_cnt                     UInt16 comment     '金融行为标签:消金类app使用个数',
     cfapp_days                    UInt16 comment     '金融行为标签:消金类app使用天数',
     microcredit_cnt               UInt16 comment     '金融行为标签:网络小贷类app使用个数',
     microcredit_days              UInt16 comment     '金融行为标签:网络小贷类app使用天数',
     creditapp_cnt                 UInt16 comment     '金融行为标签:信用卡类app使用个数',
     creditapp_days                UInt16 comment     '金融行为标签:信用卡类app使用天数',
     futures_cnt                   UInt16 comment     '金融行为标签:期货贵金属类app使用个数',
     futures_days                  UInt16 comment     '金融行为标签:期货贵金属类app使用天数',
     bankapp_cnt                   UInt16 comment     '金融行为标签:银行类app使用个数',
     bankapp_days                  UInt16 comment     '金融行为标签:银行类app使用天数',
     fundapp_cnt                   UInt16 comment     '金融行为标签:基金类app使用个数',
     fundapp_days                  UInt16 comment     '金融行为标签:基金类app使用天数',
     flightapp_cnt_m3              UInt16 comment     '其他行为标签:最近3个月航空类app使用个数',
     videoapp_cnt_m3               UInt16 comment     '其他行为标签:最近3个月视频类app使用个数',
     oversea_edu_cnt_m3            UInt16 comment     '其他行为标签:最近3个月留学教育类app使用个数',
     vocational_edu_cnt_m3         UInt16 comment     '其他行为标签:最近3个月职业教育类app使用个数',
     school_edu_cnt_m3             UInt16 comment     '其他行为标签:最近3个月中小学教育类app使用个数',
     jobapp_cnt_m3                 UInt16 comment     '其他行为标签:最近3个月职场类app使用个数',
	 babyapp_cnt_m3                UInt16 comment     '其他行为标签:最近3个月母婴类app使用个数',
	 shopapp_cnt_m3                UInt16 comment     '其他行为标签:最近3个月购物类app使用个数',
	 car_trade_cnt_m3              UInt16 comment     '其他行为标签:最近3个月汽车交易类app使用个数',
	 car_maintenance_cnt_m3        UInt16 comment     '其他行为标签:最近3个月汽车保养类app使用个数',
	 house_trade_cnt_m3            UInt16 comment     '其他行为标签:最近3个月房屋交易类app使用个数',
	 house_decoration_cnt_m3       UInt16 comment     '其他行为标签:最近3个月房屋装修类app使用个数',
	 bondapp_cnt_m3                UInt16 comment     '金融行为标签:最近3个月股票类app使用个数',
	 econapp_cnt_m3                UInt16 comment     '金融行为标签:最近3个月理财类app使用个数',
	 loanapp_cnt_m3                UInt16 comment     '金融行为标签:最近3个月贷款类app使用个数',
	 insapp_cnt_m3                 UInt16 comment     '金融行为标签:最近3个月保险类app使用个数',
	 cfapp_cnt_m3                  UInt16 comment     '金融行为标签:最近3个月消金类app使用个数',
	 microcredit_cnt_m3            UInt16 comment     '金融行为标签:最近3个月网络小贷类app使用个数',
	 creditapp_cnt_m3              UInt16 comment     '金融行为标签:最近3个月信用卡类app使用个数',
	 futures_cnt_m3                UInt16 comment     '金融行为标签:最近3个月期货贵金属类app使用个数',
	 bankapp_cnt_m3                UInt16 comment     '金融行为标签:最近3个月银行类app使用个数',
	 fundapp_cnt_m3                UInt16 comment     '金融行为标签:最近3个月基金类app使用个数',
	 lng_day                       Float64 comment     '日 经度',
	 lat_day                       Float64 comment     '日 维度',
	 lng_night                     Float64 comment     '夜 经度',
	 lat_night                     Float64 comment     '夜 维度',
     whether_resident	           UInt16 comment     '人口属性标签:是否常驻',
     whether_return_home	       UInt16 comment     '人口属性标签:是否返乡',
     nationbank_sms_cnt_m3	       UInt16 comment     '金融行为标签:最近三月国有银行短信家数',
     nationbank_sms_num_m3	       UInt16 comment     '金融行为标签:最近三月国有银行短信次数',
     commbank_sms_cnt_m3	       UInt16 comment     '金融行为标签:最近三月股份制银行短信家数',
     commbank_sms_num_m3	       UInt16 comment     '金融行为标签:最近三月股份制银行短信次数',
     ruralbank_sms_cnt_m3	       UInt16 comment     '金融行为标签:最近三月城商农商银行短信家数',
     ruralbank_sms_num_m3	       UInt16 comment     '金融行为标签:最近三月城商农商银行短信次数',
     foreignbank_sms_cnt_m3	       UInt16 comment     '金融行为标签:最近三月外资银行短信家数',
     foreignbank_sms_num_m3	       UInt16 comment     '金融行为标签:最近三月外资银行短信次数',
     gjj_sms_num_m12	           UInt16 comment     '金融行为标签:最近12个月公积金短信次数',
     gjj_sms_num_m3	               UInt16 comment     '金融行为标签:最近三月公积金短信次数',
     bank_sms_cnt_m3	           UInt16 comment     '金融行为标签:最近三个月银行短信家数',
     bank_sms_num_m3	           UInt16 comment     '金融行为标签:最近三个月银行短信次数',
     whether_ccb	               UInt16 comment     '金融行为标签:是否建行客户',
     whether_abc	               UInt16 comment     '金融行为标签:是否农行客户',
     whether_psbc	               UInt16 comment     '金融行为标签:是否邮储客户',
     debitnumber	               UInt16 comment     '风险标签:多头标签',
     credit_possibility	           UInt16 comment     '申请信用卡的可能性',
     econapp_possibility	       UInt16 comment     '购买理财的可能性',
     credit_pay_possibility	       UInt16 comment     '申请信用卡账单分期的可能性',
     phone_staging_possibility	   UInt16 comment     '申请办理手机分期的可能性',
     insurance_possibility	       UInt16 comment     '购买保险的可能性',
     fixed_deposit_possibility	   UInt16 comment     '办理定存的可能性',
     credit_loans_possibility	   UInt16 comment     '申请信贷的可能性',
     internet_banking_possibility  UInt16 comment     '办理电子银行的可能性',
     city_num	                   UInt16 comment     '位置标签:近一个月经过地市数',
     prov_num	                   UInt16 comment     '位置标签:近一个月经过省份数',																	
	 test_sign                     UInt8 comment      '基础标签:测试标签',
	 month_id                      Date   comment     '账期'
) engine = ReplicatedReplacingMergeTree('/clickhouse/tables/01/cmcc_panorama', '{replica}')
      partition by toYYYYMM(month_id)
      order by (phone_no, month_id)
      primary key phone_no
      ttl month_id + interval 3 month
     
